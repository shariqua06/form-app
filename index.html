<!DOCTYPE html>
<html lang="ta">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Form with Camera & Speech (Tamil)</title>
</head>
<body>
  <h2>படம் மற்றும் உரை மூலம் பணம் கேட்கும் படிவம்</h2>
  <form id="mainForm" autocomplete="off">
    <label for="name">பெயர் (Name): </label>
    <input type="text" id="name" name="name" /><br /><br />
    <label for="amount">பணம் அடக்கு (Withdraw Money): </label>
    <input type="number" id="amount" name="amount" /><br /><br />
    <label for="desc">விவரம் (Description): </label>
    <textarea id="desc" name="desc" rows="3" style="width: 200px"></textarea>
    <button type="button" onclick="startSpeech('desc')">உரை மூலம் உள்ளிடவும் (Use Speech)</button>
    <br /><br />
    <!-- Photo upload input triggers device camera on mobile -->
    <label for="photo">படம் எடு (Take a Photo):</label>
    <input type="file" id="photo" accept="image/*" capture="environment" />
    <br /><br />
    <button type="submit">சமர்ப்பிக்கவும் (Submit)</button>
  </form>

  <h3>Live Camera Preview</h3>
  <video id="liveCam" width="320" height="240" autoplay playsinline style="border: 1px solid #ccc;"></video>
  <br />
  <button type="button" onclick="capturePhoto()">Live கேமரா புகைப்படம் எடு (Capture Photo)</button>
  <canvas id="canvas" width="320" height="240" style="display: none; border: 1px solid #ccc;"></canvas>

  <script>
    // Show live camera on supported browsers
    if (navigator.mediaDevices && navigator.mediaDevices.getUserMedia) {
      navigator.mediaDevices
        .getUserMedia({ video: { width: 1280, height: 720 } })
        .then((stream) => {
          document.getElementById('liveCam').srcObject = stream;
        })
        .catch((err) => {
          console.error('Camera error:', err);
        });
    }

    // Capture snapshot from live camera
    function capturePhoto() {
      const video = document.getElementById('liveCam');
      const canvas = document.getElementById('canvas');
      canvas.getContext('2d').drawImage(video, 0, 0, canvas.width, canvas.height);
      canvas.style.display = 'block';
    }

    // Speech to text Tamil using webkitSpeechRecognition
    function startSpeech(targetId) {
      if (!('webkitSpeechRecognition' in window)) {
        alert('உரை அறிமுகம் உங்கள் உலாவியில் கிடைக்கவில்லை! (Speech recognition not supported)');
        return;
      }
      const recognition = new webkitSpeechRecognition();
      recognition.lang = 'ta-IN';
      recognition.interimResults = false;
      recognition.maxAlternatives = 1;
      recognition.start();

      recognition.onresult = (event) => {
        document.getElementById(targetId).value = event.results[0][0].transcript;
      };
      recognition.onerror = (event) => {
        alert('உரை பிழை: ' + event.error);
      };
    }

    // Handle form submission
    document.getElementById('mainForm').onsubmit = function (e) {
      e.preventDefault();
      alert(`படிவம் சமர்ப்பிக்கப்பட்டது!
பெயர்: ${this.name.value}
பணம்: ${this.amount.value}
விவரம்: ${this.desc.value}`);
    };
  </script>
</body>
</html>
